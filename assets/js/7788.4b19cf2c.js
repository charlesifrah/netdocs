"use strict";(self.webpackChunkdyte_docs=self.webpackChunkdyte_docs||[]).push([["7788"],{11029:function(t,e,s){s.d(e,{d:function(){return f}});var i=s(9079),r=/\s/,l=/^\s+/,o=0/0,n=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,h=/^0o[0-7]+$/i,d=parseInt;function c(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||(0,i.i)(e)&&"[object Symbol]"==(0,i.b)(e))return o;if((0,i.a)(t)){var e,s,c="function"==typeof t.valueOf?t.valueOf():t;t=(0,i.a)(c)?c+"":c}if("string"!=typeof t)return 0===t?t:+t;t=(s=t)?s.slice(0,function(t){for(var e=t.length;e--&&r.test(t.charAt(e)););return e}(s)+1).replace(l,""):s;var g=a.test(t);return g||h.test(t)?d(t.slice(2),g?2:8):n.test(t)?o:+t}var g=function(){return i.r.Date.now()},u=Math.max,m=Math.min;function f(t,e,s){var r,l,o,n,a,h,d=0,f=!1,v=!1,p=!0;if("function"!=typeof t)throw TypeError("Expected a function");function b(e){var s=r,i=l;return r=l=void 0,d=e,n=t.apply(i,s)}function y(t){var s=t-h,i=t-d;return void 0===h||s>=e||s<0||v&&i>=o}function S(){var t,s,i,r=g();if(y(r))return T(r);a=setTimeout(S,(t=r-h,s=r-d,i=e-t,v?m(i,o-s):i))}function T(t){return(a=void 0,p&&r)?b(t):(r=l=void 0,n)}function I(){var t,s=g(),i=y(s);if(r=arguments,l=this,h=s,i){if(void 0===a)return d=t=h,a=setTimeout(S,e),f?b(t):n;if(v)return clearTimeout(a),a=setTimeout(S,e),b(h)}return void 0===a&&(a=setTimeout(S,e)),n}return e=c(e)||0,(0,i.a)(s)&&(f=!!s.leading,o=(v="maxWait"in s)?u(c(s.maxWait)||0,e):o,p="trailing"in s?!!s.trailing:p),I.cancel=function(){void 0!==a&&clearTimeout(a),d=0,r=h=l=a=void 0},I.flush=function(){return void 0===a?n:T(g())},I}},82639:function(t,e,s){s.r(e),s.d(e,{dyte_message_list_view:function(){return o}});var i=s(84982);s(39415),s(79598),s(78410);var r=s(48724);s(51943);var l=s(11029);s(94098),s(81479),s(9079);let o=class{constructor(t){(0,i.r)(this,t),this.sizes=new Map,this.lastScrollTop=0,this.scrollToBottomRetries=0,this.elementObserver=(()=>{let t=null,e=()=>t||("undefined"!=typeof ResizeObserver?t=new ResizeObserver(t=>{t.forEach(t=>{this.measureElement(t.target,t)})}):null);return{disconnect:()=>{var t;return null===(t=e())||void 0===t?void 0:t.disconnect()},observe:t=>{var s;return null===(s=e())||void 0===s?void 0:s.observe(t,{box:"border-box"})},unobserve:t=>{var s;return null===(s=e())||void 0===s?void 0:s.unobserve(t)}}})(),this.measureElement=(t,e)=>{if(!t)return;let s=t.dataset.id;if(this.sizes.has(s)){this.elementObserver.unobserve(t);return}if(e){let i=e.borderBoxSize[0];if(i&&i.blockSize>0){this.saveItemSize(s,i.blockSize),this.elementObserver.unobserve(t);return}}let i=t.getBoundingClientRect();i.height>0&&this.saveItemSize(s,i.height)},this.getVisibleItems=()=>this.messages.slice(this.range.start,this.range.end+1),this.updateVisibleItems=(t,e)=>{let s=this.messages.length,i=t,r=e;s<=this.visibleItemsCount?(i=0,r=s-1):e-t<this.visibleItemsCount-1&&(i=this.range.end-this.visibleItemsCount+1),this.range.start!==i&&(this.range={start:i,end:r},this.totalHeight=this.getRangeSize(0,s))},this.getEstimatedItemSize=()=>this.estimateItemSize,this.getRangeSize=(t,e)=>{let s=0,i=0;for(let i=t;i<e;i++)s+=this.sizes.get(this.messages[i].id)||this.getEstimatedItemSize();return s},this.getScrollTop=()=>this.$listRef?Math.ceil(this.$listRef.scrollTop):0,this.getClientHeight=()=>this.$listRef?Math.ceil(this.$listRef.clientHeight):0,this.getScrollHeight=()=>this.$listRef?Math.ceil(this.$listRef.scrollHeight):0,this.getItemsScrolled=()=>{let t=this.lastScrollTop;if(t<=0)return 0;let e=0,s=0,i=0,r=this.messages.length;for(;e<=r;){if(s=e+r>>>1,(i=this.getRangeSize(0,s))===t)return s;i<t?e=s+1:i>t&&(r=s-1)}return e>0?--e:0},this.getEndByStart=t=>Math.min(t+this.visibleItemsCount,this.messages.length-1),this.scrollToOffset=t=>{this.$listRef&&(this.$listRef.scrollTop=t)},this.scrollToIndex=t=>{if(t>=this.messages.length-1)this.scrollToBottom();else{let e=t<1?0:this.getRangeSize(0,t);this.scrollToOffset(e)}},this.scrollToBottom=()=>{this.$listEndRef&&(0,i.w)(()=>{this.$listEndRef.scrollIntoView(),this.getScrollHeight()-(this.getScrollTop()+this.getClientHeight())>0&&this.scrollToBottomRetries<10?setTimeout(()=>{this.scrollToBottom()},1e3/60):(this.scrollToBottomRetries=0,this.autoScroll=!0)})},this.handleScroll=async()=>{if(this.isFetching)return;let t=this.getScrollTop(),e=t<this.lastScrollTop||0===t?"UP":"DOWN";if(this.lastScrollTop=t,this.loadMore&&0===t&&"UP"===e&&!1===this.isFetching){this.isFetching=!0;let t=await this.loadMore(this.messages[0]);t&&t.length&&(this.messages=[...t,...this.messages]),this.isFetching=!1}"UP"===e?this.handleTop():"DOWN"===e&&this.handleBottom()},this.handleTop=()=>{let t=this.getItemsScrolled();if(t<=this.range.end-5&&(this.autoScroll=!1),t>this.range.start+5)return;let e=Math.max(this.range.start-5,0);this.updateVisibleItems(e,this.getEndByStart(e))},this.handleBottom=()=>{if(this.getItemsScrolled()<this.range.start+5)return;let t=this.range.start+5,e=this.getEndByStart(t);e===this.messages.length-1?this.updateVisibleItems(e-this.visibleItemsCount,e):this.updateVisibleItems(t,e)},this.updateTotalHeight=(0,l.d)(()=>{this.totalHeight=this.getRangeSize(0,this.messages.length)},1e3/30,{leading:!0}),this.rendererInternal=(t,e,s)=>{if(!t||t.dataset.id===e.id)return;let i=this.renderer(e,s);t.hasChildNodes&&(t.innerHTML=""),this.elementObserver.observe(t),t.dataset.id=e.id,t.appendChild(i)},this.messages=void 0,this.renderer=void 0,this.loadMore=void 0,this.visibleItemsCount=20,this.estimateItemSize=100,this.iconPack=r.d,this.range=void 0,this.isFetching=!1,this.autoScroll=!0,this.totalHeight=0}connectedCallback(){let t=this.messages.length-1;this.range={start:t-this.visibleItemsCount,end:t},this.updateVisibleItems(this.range.start,this.range.end),this.totalHeight=this.getRangeSize(0,t)}componentDidLoad(){this.autoScroll&&this.scrollToBottom()}messagesUpdated(t,e){if(t.length>e.length){let s=t.length-e.length;this.updateVisibleItems(s,this.getEndByStart(s)),this.scrollToIndex(this.range.start)}}saveItemSize(t,e){this.sizes.set(t,Math.round(e)),this.updateTotalHeight()}render(){return(0,i.h)("div",{class:"scrollbar content-wrapper",ref:t=>this.$listRef=t,onScroll:this.handleScroll},(0,i.h)("div",{class:"scroller"},(0,i.h)("div",{style:{height:`${this.totalHeight}px`}}),(0,i.h)("div",{class:"smallest-dom-element",id:"list-end",ref:t=>this.$listEndRef=t})),(0,i.h)("div",{class:"content",style:{transform:`translateY(${this.getRangeSize(0,this.range.start)}px)`}},this.isFetching&&(0,i.h)("div",{class:"loader"},(0,i.h)("dyte-spinner",{size:"md"})),this.getVisibleItems().map((t,e)=>(0,i.h)("div",{key:t.id,ref:s=>this.rendererInternal(s,t,e)}))))}static get watchers(){return{messages:["messagesUpdated"]}}};o.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}.loading{cursor:wait}.content-wrapper{height:100%;overflow-y:auto;position:relative;contain:strict}.scroller{width:1px;opacity:0}.content{position:absolute;top:0;width:100%}.smallest-dom-element{width:100%;height:2px;background:red}.loader{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);display:flex;justify-content:center}"}}]);